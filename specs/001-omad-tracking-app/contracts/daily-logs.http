### Daily Log Endpoints
### Track daily OMAD compliance, alcohol consumption, and weight

@baseUrl = https://localhost:7001
@apiBaseUrl = {{baseUrl}}/api
@today = 2025-11-22

###
# 1. Log Today's Data (US2 - Primary Interaction)
# 10-second daily check-in: OMAD compliance, alcohol, current weight
POST {{apiBaseUrl}}/daily-logs
Content-Type: application/json
Cookie: .AspNetCore.Identity.Application={session_cookie}

{
  "date": "2025-11-22",
  "omadCompliant": true,
  "alcoholConsumed": false,
  "weight": 178.5
}
# Returns: 201 Created
# Location: /api/daily-logs/2025-11-22
# {
#   "date": "2025-11-22",
#   "omadCompliant": true,
#   "alcoholConsumed": false,
#   "weight": 178.5,
#   "serverTimestamp": "2025-11-22T14:30:00Z"
# }

###
# 2. Get Specific Day's Log (US2 - Edit Existing Entry)
# Retrieve log to pre-fill modal when user clicks on previously logged day
GET {{apiBaseUrl}}/daily-logs/2025-11-22
Cookie: .AspNetCore.Identity.Application={session_cookie}
# Returns: 200 OK
# {
#   "date": "2025-11-22",
#   "omadCompliant": true,
#   "alcoholConsumed": false,
#   "weight": 178.5,
#   "serverTimestamp": "2025-11-22T14:30:00Z"
# }
# Returns: 404 Not Found (if day not logged)

###
# 3. Update Existing Log (US2 - Edit Entry)
# User clicks on previously logged day and modifies data
PUT {{apiBaseUrl}}/daily-logs/2025-11-22
Content-Type: application/json
Cookie: .AspNetCore.Identity.Application={session_cookie}

{
  "date": "2025-11-22",
  "omadCompliant": true,
  "alcoholConsumed": true,
  "weight": 179.0
}
# Returns: 200 OK
# {
#   "date": "2025-11-22",
#   "omadCompliant": true,
#   "alcoholConsumed": true,
#   "weight": 179.0,
#   "serverTimestamp": "2025-11-22T15:45:00Z"
# }

###
# 4. Get Monthly Logs (US3 - Calendar Dashboard)
# Retrieve all logs for a month to render calendar grid
GET {{apiBaseUrl}}/daily-logs?year=2025&month=11
Cookie: .AspNetCore.Identity.Application={session_cookie}
# Returns: 200 OK
# {
#   "logs": [
#     {
#       "date": "2025-11-01",
#       "omadCompliant": true,
#       "alcoholConsumed": false,
#       "weight": 180.0
#     },
#     {
#       "date": "2025-11-02",
#       "omadCompliant": false,
#       "alcoholConsumed": true,
#       "weight": 181.0
#     }
#     // ... up to 30 entries
#   ],
#   "currentStreak": 5
# }

###
# 5. Get Current Streak (US3 - Streak Counter)
GET {{apiBaseUrl}}/daily-logs/streak
Cookie: .AspNetCore.Identity.Application={session_cookie}
# Returns: 200 OK
# {
#   "currentStreak": 12,
#   "lastOmadDate": "2025-11-22"
# }

###
# 6. Validation: Future Date Prevention (FR-015)
POST {{apiBaseUrl}}/daily-logs
Content-Type: application/json
Cookie: .AspNetCore.Identity.Application={session_cookie}

{
  "date": "2025-12-31",
  "omadCompliant": true,
  "alcoholConsumed": false,
  "weight": 178.5
}
# Returns: 400 Bad Request (RFC 7807 Problem Details)
# {
#   "type": "https://tools.ietf.org/html/rfc7231#section-6.5.1",
#   "title": "Validation Error",
#   "status": 400,
#   "errors": {
#     "Date": ["Cannot log dates in the future (FR-015)"]
#   }
# }

###
# 7. Validation: Weight Change Exceeds 5 lbs (FR-017b - Confirmation Needed)
# Previous weight was 178.5, new weight is 184.0 (5.5 lb increase)
POST {{apiBaseUrl}}/daily-logs
Content-Type: application/json
Cookie: .AspNetCore.Identity.Application={session_cookie}

{
  "date": "2025-11-23",
  "omadCompliant": true,
  "alcoholConsumed": false,
  "weight": 184.0
}
# Returns: 409 Conflict (requires confirmation)
# {
#   "type": "https://tools.ietf.org/html/rfc7231#section-6.5.8",
#   "title": "Confirmation Required",
#   "status": 409,
#   "detail": "Weight change exceeds 5 lbs (previous: 178.5, new: 184.0). Please confirm this entry is correct (FR-017b).",
#   "previousWeight": 178.5,
#   "newWeight": 184.0,
#   "changeAmount": 5.5
# }

###
# 8. Confirm Weight Change (After User Confirmation)
POST {{apiBaseUrl}}/daily-logs
Content-Type: application/json
Cookie: .AspNetCore.Identity.Application={session_cookie}

{
  "date": "2025-11-23",
  "omadCompliant": true,
  "alcoholConsumed": false,
  "weight": 184.0,
  "confirmed": true
}
# Returns: 201 Created (same as #1)

###
# 9. Validation: Invalid Weight Range (FR-005)
POST {{apiBaseUrl}}/daily-logs
Content-Type: application/json
Cookie: .AspNetCore.Identity.Application={session_cookie}

{
  "date": "2025-11-22",
  "omadCompliant": true,
  "alcoholConsumed": false,
  "weight": -10.0
}
# Returns: 400 Bad Request (RFC 7807 Problem Details)
# {
#   "type": "https://tools.ietf.org/html/rfc7231#section-6.5.1",
#   "title": "Validation Error",
#   "status": 400,
#   "errors": {
#     "Weight": ["Weight must be between 50 and 500 lbs (FR-005)"]
#   }
# }

###
# 10. Delete Log (Optional - not in MVP, but useful for testing)
DELETE {{apiBaseUrl}}/daily-logs/2025-11-22
Cookie: .AspNetCore.Identity.Application={session_cookie}
# Returns: 204 No Content
